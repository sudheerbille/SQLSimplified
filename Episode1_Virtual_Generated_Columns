-- SNOWFLAKE CODE BLOCK --
-- Setup Context --
USE ROLE SYSADMIN;
CREATE OR REPLACE DATABASE EMPLOYEES;
CREATE OR REPLACE TABLE EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME VARCHAR (10),LAST_NAME VARCHAR(20),EMAIL_ID VARCHAR(80));

-- INSERT SAMPLE DATA --

Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Adam','Fripp');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alana','Walsh');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alberto','Errazuriz');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Hunold');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Khoo');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexis','Bull');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Allan','McEwen');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alyssa','Hutton');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Amit','Banda');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Anthony','Cabrio');

-- First method --

UPDATE EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN
SET EMAIL_ID = FIRST_NAME||'.'||LAST_NAME||'@XYZ.COM';

-- Fetch data from the table --
SELECT * FROM EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN;

-- Second Method --
-- Truncate the table --
TRUNCATE TABLE EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN;

-- Drop the Email_id Column and add it back as a virtual/generate column--
ALTER TABLE EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN
DROP COLUMN EMAIL_ID;

ALTER TABLE EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN
ADD COLUMN EMAIL_ID VARCHAR(80) AS (FIRST_NAME||'.'||LAST_NAME||'@XYZ.COM');

Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Adam','Fripp');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alana','Walsh');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alberto','Errazuriz');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Hunold');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Khoo');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexis','Bull');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Allan','McEwen');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alyssa','Hutton');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Amit','Banda');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Anthony','Cabrio');

-- Fetch data from the table --
SELECT * FROM EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN;

-- Third Method --
CREATE OR REPLACE TABLE EMPLOYEES (FIRST_NAME VARCHAR (10),LAST_NAME VARCHAR(20),EMAIL_ID VARCHAR(80) AS (FIRST_NAME||'.'||LAST_NAME||'@XYZ.COM'));

Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Adam','Fripp');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alana','Walsh');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alberto','Errazuriz');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Hunold');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Khoo');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexis','Bull');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Allan','McEwen');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Alyssa','Hutton');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Amit','Banda');
Insert into EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN (FIRST_NAME,LAST_NAME) values ('Anthony','Cabrio');

-- Fetch data from the table --
SELECT * FROM EMPLOYEES.PUBLIC.EMPLOYEES_VIRTUAL_COLUMN;

-- Oracle Code Block --

CREATE TABLE EMPLOYEES_GENERATED_COLUMN (FIRST_NAME VARCHAR2 (10),LAST_NAME VARCHAR2(20),EMAIL_ID VARCHAR2(80));

-- INSERT SAMPLE DATA --

Insert into EMPLOYEE_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Adam','Fripp');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alana','Walsh');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alberto','Errazuriz');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Hunold');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Khoo');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexis','Bull');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Allan','McEwen');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alyssa','Hutton');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Amit','Banda');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Anthony','Cabrio');

-- First method --

UPDATE EMPLOYEES_GENERATED_COLUMN
SET EMAIL_ID = FIRST_NAME||'.'||LAST_NAME||'@XYZ.COM';

-- Fetch data from the table --
SELECT * FROM EMPLOYEES_GENERATED_COLUMN;

-- Second Method --
-- Truncate the table --
TRUNCATE TABLE EMPLOYEES_GENERATED_COLUMN;

-- Drop the Email_id Column and add it back as a virtual/generate column--
ALTER TABLE EMPLOYEES_GENERATED_COLUMN
DROP COLUMN EMAIL_ID;

ALTER TABLE EMPLOYEES_GENERATED_COLUMN
ADD EMAIL_ID VARCHAR2(80) GENERATED ALWAYS AS (FIRST_NAME||'.'||LAST_NAME||'@XYZ.COM');

Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Adam','Fripp');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alana','Walsh');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alberto','Errazuriz');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Hunold');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexander','Khoo');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alexis','Bull');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Allan','McEwen');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Alyssa','Hutton');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Amit','Banda');
Insert into EMPLOYEES_GENERATED_COLUMN (FIRST_NAME,LAST_NAME) values ('Anthony','Cabrio');

-- Fetch data from the table --
SELECT * FROM EMPLOYEES_GENERATED_COLUMN;
